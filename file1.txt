First iteration of the code.
And some modification
